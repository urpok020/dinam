y=[    7.7456641e-001  8.6727957e-001  8.1181767e-001  8.6616611e-001  8.6354032e-001  8.6445265e-001  8.7041073e-001  9.1139780e-001  8.4529084e-001  8.4374968e-001  7.5979219e-001  7.2559653e-001  7.2413420e-001  5.8669077e-001  5.2062260e-001  5.2100358e-001  4.7775025e-001  3.2780867e-001  3.1334251e-001  1.9369168e-001  1.7976991e-001  1.0528381e-001 -1.8848199e-002 -7.0582594e-003 -4.8989346e-002 -1.6131903e-001 -2.2407295e-001 -3.0299740e-001 -3.3012692e-001 -3.3447694e-001 -3.6731654e-001 -4.3186585e-001 -4.1603716e-001 -4.9446554e-001 -4.2009462e-001 -5.1329855e-001 -4.9241720e-001 -4.5899884e-001 -4.6723946e-001 -4.5355533e-001 -4.5353204e-001 -3.9544986e-001 -4.2143281e-001 -3.5891724e-001 -3.0299193e-001 -3.3111541e-001 -2.4982734e-001 -2.1782676e-001 -2.4842133e-001 -2.0863160e-001 -1.4604171e-001 -8.2022535e-002 -4.8615800e-002 -1.0789057e-002 -4.3351407e-002  1.6568175e-003  9.6579944e-002  1.3382840e-001  1.5160971e-001  1.9628287e-001  2.1619413e-001  1.6626969e-001  2.1192885e-001  2.5390110e-001  2.3869829e-001  2.5666572e-001  2.5639698e-001  2.7654478e-001  2.0996424e-001  2.5049074e-001  2.1932831e-001  2.2288086e-001  2.3495763e-001  2.4284033e-001  1.9659887e-001  1.9144862e-001  1.3753586e-001  1.2892442e-001  1.1859671e-001  1.1547496e-001  7.5182578e-002  5.7884061e-002  1.0105697e-001  5.0994044e-002  6.7062528e-002  1.6334050e-002 -3.8385118e-002 -7.0344161e-002 -4.2118630e-002 -6.7537800e-002 -5.6479561e-002 -6.2201483e-002 -1.0932999e-001 -1.0220999e-001 -1.4658287e-001 -7.9464001e-002 -1.2768886e-001 -1.5498181e-001 -1.6183614e-001 -9.0144276e-002 -1.1577556e-001 -1.1186689e-001 -1.1362820e-001 -9.6903344e-002 -1.1113887e-001 -1.1225467e-001 -6.7208819e-002 -1.0751484e-001 -1.1361230e-001 -1.0023447e-001 -2.8014443e-002 -3.8009184e-002 -1.2563224e-002 -4.9513030e-002 -1.3622292e-002 -6.3447599e-002  3.5485663e-002  2.1351722e-004  1.4570118e-002  4.8057579e-002  1.3329471e-002  4.9960445e-002  2.7025567e-002  3.1694457e-002  7.0679771e-002  5.4142917e-002  2.4960834e-002  4.1374096e-002  1.1721288e-001  9.1397341e-002  8.8139501e-002  5.4728786e-002  2.3294178e-002  7.6857449e-002  2.1289688e-002  4.1371800e-002  3.0651826e-002  5.2706939e-002  8.0394330e-002  6.1695601e-002  2.5428489e-002  1.7965333e-002 -8.8036436e-003 -4.9501668e-003  4.4398973e-002 -2.4376593e-002  5.2916773e-002 -1.3358296e-003 -4.1615069e-002  2.5462020e-003
];
dt=0.1;
sko1 = zeros(25,1)
pp = zeros(25,1)
N=150;
for i=1:N
	t(i)=dt*(i-1);
end
hold on
plot(t,y)

for p=25:25
pp(p - 1) = p
	for i=1:p
		for j=1:N-p
			Y_1(i,j)=y(p-i+j);
		end
	end
	for i=p+1:N
		Y_2(i-p)=-y(i);
	end
	Y_1=Y_1';
	Y_2=Y_2';
	A=inv(Y_1'*Y_1)*Y_1'*Y_2;
	pol(1)=1;
	for i=1:p
		pol(1+i)=A(i);
	end
	zi=roots(pol);
	for i=1:p
		   omeg(i)=angle(zi(i))/dt;
	end
	for i=1:p
		   a(i)=real(log(zi(i)))/dt;
	end
	Y=y';
	for j=1:p
		for i=1:N
			Fi(i,j)=zi(j)^(i-1);
		end
	end
	B=inv(Fi'*Fi)*Fi'*Y;
	for i=1:p
		A_b(i)=abs(B(i));
	end
	for i=1:p
		fi(i) = angle(B(i));
	end
	s=0;
	y_p=zeros(1,N);
	for i=1:N
		for j=1:p
			y_p(i)=y_p(i)+ A_b(j)*exp(a(j)*t(i))*cos(omeg(j)*t(i)+fi(j));
		end
	s=s+y(i); % рассчёт саз
	end
	plot(t,y_p)
	
	for i=1:N
		sko=std(y-y_p);
	end
	sko=sko/(N-1);
	
	disp('для p=')
	disp(p)
	sko1(p)=sqrt(sko)
	% очистка данных
	clear a
	clear A
	clear A_b
	clear B
	clear Fi
	clear Y
	clear Y_1
	clear Y_2
	clear fi
	clear i
	clear j
	clear omeg
	clear pol
	clear y_p
	clear zi
	clear s
	clear sko
end
