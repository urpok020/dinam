y=[  6.5550343e-001  5.3894372e-001  4.6289970e-001  4.3858309e-001  3.2482785e-001  2.5213551e-001  1.0225627e-001  7.5743269e-002 -7.8864124e-002 -8.5343461e-002 -2.1778335e-001 -3.0855361e-001 -3.1626189e-001 -4.2248665e-001 -4.6227984e-001 -4.8474229e-001 -5.1636642e-001 -5.9297827e-001 -6.4841415e-001 -6.4999137e-001 -6.0868344e-001 -5.9859698e-001 -6.3314734e-001 -5.8743304e-001 -6.0668528e-001 -5.4709243e-001 -5.4386533e-001 -5.7095530e-001 -5.0296031e-001 -4.5196997e-001 -3.8720705e-001 -3.6952966e-001 -2.8289518e-001 -3.2170493e-001 -2.5603829e-001 -1.8797372e-001 -1.7304788e-001 -1.1409992e-001 -7.0750920e-002  2.4909151e-002  3.4947418e-002  1.2380441e-001  1.3909708e-001  1.4437279e-001  2.2362602e-001  1.9008432e-001  2.6908152e-001  3.3413183e-001  2.9018668e-001  3.2505037e-001  3.7334427e-001  3.1422570e-001  3.7536324e-001  3.0986922e-001  3.7708507e-001  3.1048196e-001  3.5775521e-001  3.4086081e-001  2.6381854e-001  3.2507412e-001  2.3277301e-001  2.6359210e-001  2.4360138e-001  1.8784919e-001  2.0420111e-001  9.6642467e-002  7.3673855e-002  1.1938620e-001  9.0717470e-003  5.4142862e-002  3.7775332e-002 -5.6543034e-002 -4.2447215e-002 -7.8367835e-002 -5.6035362e-002 -1.2356138e-001 -8.6544213e-002 -1.6669723e-001 -1.1070457e-001 -1.1551868e-001 -1.9802491e-001 -2.1905540e-001 -1.7415507e-001 -2.3094182e-001 -1.4998462e-001 -1.4099536e-001 -1.5853472e-001 -2.0023124e-001 -1.5953934e-001 -1.1699404e-001 -1.1241378e-001 -1.3122318e-001 -1.0144169e-001 -8.5003236e-002 -9.9810957e-002 -1.4238440e-001 -1.0353781e-001 -7.1421257e-002 -5.7394324e-002  1.1790913e-003 -6.5647993e-002 -2.4807283e-002 -2.7921832e-002 -8.4155273e-003  5.1704521e-002  1.8921839e-002  2.4167501e-002  2.3812386e-002  4.0353978e-002  1.0744386e-001  6.9858893e-002  1.0384983e-001  1.3504641e-001  8.7184928e-002  1.0704117e-001  1.4441079e-001  8.3815632e-002  1.1270587e-001  7.5709408e-002  1.2989790e-001  6.7156970e-002  6.2668989e-002  1.1869897e-001  7.1544798e-002  3.6724736e-002  1.1919639e-002  1.9342798e-002  2.5282295e-002  8.3744885e-002  5.8428365e-002  3.9839331e-002  4.9103650e-002 -2.2513453e-004  2.0930746e-002 -8.1727616e-003  1.9230849e-002 -2.5226540e-002  1.1326900e-002 -7.9010700e-002  1.4982382e-002 -6.1283201e-002 -8.9074995e-002 -8.0265743e-002 -4.9982456e-002 -1.0939131e-002 -7.2781484e-002 -2.3439009e-002 -8.4984064e-002 -2.8528927e-002 -7.6119193e-002];
p=2;
N=150;
for i=1:p
    for j=1:N-p
        Y1(i,j)=y(p-i+j)
    end;
end;
for i=p+1:N
    Y2(i-p)=-y(i)
end;
Y_1=Y1';
Y_2=Y2';
A=inv(Y_1'*Y_1)*Y_1'*Y_2;
pol(1)=1;
for i=1:p
    pol(1+i)=A(i)
end;
pol(p)=1;
zi=roots(pol);
yz=[4.6289970e-001  4.3858309e-001  3.2482785e-001  2.5213551e-001  1.0225627e-001  7.5743269e-002 -7.8864124e-002 -8.5343461e-002 -2.1778335e-001 -3.0855361e-001 -3.1626189e-001 -4.2248665e-001 -4.6227984e-001 -4.8474229e-001 -5.1636642e-001 -5.9297827e-001 -6.4841415e-001 -6.4999137e-001 -6.0868344e-001 -5.9859698e-001 -6.3314734e-001 -5.8743304e-001 -6.0668528e-001 -5.4709243e-001 -5.4386533e-001 -5.7095530e-001 -5.0296031e-001 -4.5196997e-001 -3.8720705e-001 -3.6952966e-001 -2.8289518e-001 -3.2170493e-001 -2.5603829e-001 -1.8797372e-001 -1.7304788e-001 -1.1409992e-001 -7.0750920e-002  2.4909151e-002  3.4947418e-002  1.2380441e-001  1.3909708e-001  1.4437279e-001  2.2362602e-001  1.9008432e-001  2.6908152e-001  3.3413183e-001  2.9018668e-001  3.2505037e-001  3.7334427e-001  3.1422570e-001  3.7536324e-001  3.0986922e-001  3.7708507e-001  3.1048196e-001  3.5775521e-001  3.4086081e-001  2.6381854e-001  3.2507412e-001  2.3277301e-001  2.6359210e-001  2.4360138e-001  1.8784919e-001  2.0420111e-001  9.6642467e-002  7.3673855e-002  1.1938620e-001  9.0717470e-003  5.4142862e-002  3.7775332e-002 -5.6543034e-002 -4.2447215e-002 -7.8367835e-002 -5.6035362e-002 -1.2356138e-001 -8.6544213e-002 -1.6669723e-001 -1.1070457e-001 -1.1551868e-001 -1.9802491e-001 -2.1905540e-001 -1.7415507e-001 -2.3094182e-001 -1.4998462e-001 -1.4099536e-001 -1.5853472e-001 -2.0023124e-001 -1.5953934e-001 -1.1699404e-001 -1.1241378e-001 -1.3122318e-001 -1.0144169e-001 -8.5003236e-002 -9.9810957e-002 -1.4238440e-001 -1.0353781e-001 -7.1421257e-002 -5.7394324e-002  1.1790913e-003 -6.5647993e-002 -2.4807283e-002 -2.7921832e-002 -8.4155273e-003  5.1704521e-002  1.8921839e-002  2.4167501e-002  2.3812386e-002  4.0353978e-002  1.0744386e-001  6.9858893e-002  1.0384983e-001  1.3504641e-001  8.7184928e-002  1.0704117e-001  1.4441079e-001  8.3815632e-002  1.1270587e-001  7.5709408e-002  1.2989790e-001  6.7156970e-002  6.2668989e-002  1.1869897e-001  7.1544798e-002  3.6724736e-002  1.1919639e-002  1.9342798e-002  2.5282295e-002  8.3744885e-002  5.8428365e-002  3.9839331e-002  4.9103650e-002 -2.2513453e-004  2.0930746e-002 -8.1727616e-003  1.9230849e-002 -2.5226540e-002  1.1326900e-002 -7.9010700e-002  1.4982382e-002 -6.1283201e-002 -8.9074995e-002 -8.0265743e-002 -4.9982456e-002 -1.0939131e-002 -7.2781484e-002 -2.3439009e-002 -8.4984064e-002 -2.8528927e-002 -7.6119193e-002];
dt=0.1;
N=150;
for i=1:N
    t(i)=dt*(i-1)
end;
hold on;
plot(t,y);
	for i=1:p
		omeg(i)=atan(imag(zi(i))/real(zi(i)))/dt;
	end
	for i=1:p
		a(i)=log(zi(i))/dt;
	end
	Y=y';
	for j=1:p
		for i=1:N
			Fi(i,j)=zi(j)^(i-1);
		end
	end
	B=inv(Fi'*Fi)*Fi'*Y;
	for i=1:p
		A_b(i)=abs(B(i));
	end
	for i=1:p
		fi(i)=atan(imag(A_b(i))/real(A_b(i)));
	end
	sex=0;
	y_po=zeros(1,N);
	for i=1:N
		for j=1:p
			y_po(i)=y_po(i)+ A_b(j)*exp(A(j)*t(i))*cos(omeg(j)*t(i)+fi(j));
		end
	sell=sell+y_po(i); % рассчёт саз
	end
	plot(t,y_po)
	
	for i=1:N
		sko=(y_po(i)-sell)^2;
	end
	sko=sko/(N-1);
	disp('для p=')
	disp(p)
	sko=sqrt(sko)
	% очистка данных
	clear a
	clear A
	clear A_b
	clear B
	clear Fi
	clear Y
	clear Y_1
	clear Y_2
	clear fi
	clear i
	clear j
	clear omeg
	clear pol
	clear y_po
	clear zi
	clear sell
	clear sko
  